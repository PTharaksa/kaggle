{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/prapawarintharaksa/spam-or-not?scriptVersionId=181881950\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"79125abe","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2024-06-06T17:35:58.09019Z","iopub.status.busy":"2024-06-06T17:35:58.089796Z","iopub.status.idle":"2024-06-06T17:35:58.94587Z","shell.execute_reply":"2024-06-06T17:35:58.944732Z"},"papermill":{"duration":0.866171,"end_time":"2024-06-06T17:35:58.948492","exception":false,"start_time":"2024-06-06T17:35:58.082321","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["/kaggle/input/phishing-email-dataset/SpamAssasin.csv\n","/kaggle/input/phishing-email-dataset/Nazario.csv\n","/kaggle/input/phishing-email-dataset/Nigerian_Fraud.csv\n","/kaggle/input/phishing-email-dataset/CEAS_08.csv\n","/kaggle/input/phishing-email-dataset/Enron.csv\n","/kaggle/input/phishing-email-dataset/Ling.csv\n","/kaggle/input/phishing-email-dataset/phishing_email.csv\n"]}],"source":["# This Python 3 environment comes with many helpful analytics libraries installed\n","# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n","# For example, here's several helpful packages to load\n","\n","import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","import os\n","for dirname, _, filenames in os.walk('/kaggle/input'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"code","execution_count":2,"id":"89932f2e","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:35:58.962935Z","iopub.status.busy":"2024-06-06T17:35:58.962398Z","iopub.status.idle":"2024-06-06T17:36:22.253552Z","shell.execute_reply":"2024-06-06T17:36:22.252425Z"},"papermill":{"duration":23.30095,"end_time":"2024-06-06T17:36:22.25613","exception":false,"start_time":"2024-06-06T17:35:58.95518","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["2024-06-06 17:36:12.063435: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","2024-06-06 17:36:12.063553: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","2024-06-06 17:36:12.213831: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"]}],"source":["# import all library\n","import matplotlib.pyplot as plt\n","import nltk\n","import gensim.downloader as api\n","import numpy as np\n","from nltk.corpus import stopwords\n","from nltk import word_tokenize\n","from keras.preprocessing.sequence import pad_sequences\n","from sklearn.model_selection import train_test_split\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.metrics import accuracy_score, recall_score, precision_score"]},{"cell_type":"markdown","id":"623a4bce","metadata":{"papermill":{"duration":0.00521,"end_time":"2024-06-06T17:36:22.267044","exception":false,"start_time":"2024-06-06T17:36:22.261834","status":"completed"},"tags":[]},"source":["# Train and Validate data"]},{"cell_type":"code","execution_count":3,"id":"2c718777","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:22.280659Z","iopub.status.busy":"2024-06-06T17:36:22.279258Z","iopub.status.idle":"2024-06-06T17:36:23.904099Z","shell.execute_reply":"2024-06-06T17:36:23.903035Z"},"papermill":{"duration":1.634112,"end_time":"2024-06-06T17:36:23.906721","exception":false,"start_time":"2024-06-06T17:36:22.272609","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sender</th>\n","      <th>receiver</th>\n","      <th>date</th>\n","      <th>subject</th>\n","      <th>body</th>\n","      <th>label</th>\n","      <th>urls</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Young Esposito &lt;Young@iworld.de&gt;</td>\n","      <td>user4@gvc.ceas-challenge.cc</td>\n","      <td>Tue, 05 Aug 2008 16:31:02 -0700</td>\n","      <td>Never agree to be a loser</td>\n","      <td>Buck up, your troubles caused by small dimensi...</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Mok &lt;ipline's1983@icable.ph&gt;</td>\n","      <td>user2.2@gvc.ceas-challenge.cc</td>\n","      <td>Tue, 05 Aug 2008 18:31:03 -0500</td>\n","      <td>Befriend Jenna Jameson</td>\n","      <td>\\nUpgrade your sex and pleasures with these te...</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Daily Top 10 &lt;Karmandeep-opengevl@universalnet...</td>\n","      <td>user2.9@gvc.ceas-challenge.cc</td>\n","      <td>Tue, 05 Aug 2008 20:28:00 -1200</td>\n","      <td>CNN.com Daily Top 10</td>\n","      <td>&gt;+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+...</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Michael Parker &lt;ivqrnai@pobox.com&gt;</td>\n","      <td>SpamAssassin Dev &lt;xrh@spamassassin.apache.org&gt;</td>\n","      <td>Tue, 05 Aug 2008 17:31:20 -0600</td>\n","      <td>Re: svn commit: r619753 - in /spamassassin/tru...</td>\n","      <td>Would anyone object to removing .so from this ...</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Gretchen Suggs &lt;externalsep1@loanofficertool.com&gt;</td>\n","      <td>user2.2@gvc.ceas-challenge.cc</td>\n","      <td>Tue, 05 Aug 2008 19:31:21 -0400</td>\n","      <td>SpecialPricesPharmMoreinfo</td>\n","      <td>\\nWelcomeFastShippingCustomerSupport\\nhttp://7...</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                              sender  \\\n","0                   Young Esposito <Young@iworld.de>   \n","1                       Mok <ipline's1983@icable.ph>   \n","2  Daily Top 10 <Karmandeep-opengevl@universalnet...   \n","3                 Michael Parker <ivqrnai@pobox.com>   \n","4  Gretchen Suggs <externalsep1@loanofficertool.com>   \n","\n","                                         receiver  \\\n","0                     user4@gvc.ceas-challenge.cc   \n","1                   user2.2@gvc.ceas-challenge.cc   \n","2                   user2.9@gvc.ceas-challenge.cc   \n","3  SpamAssassin Dev <xrh@spamassassin.apache.org>   \n","4                   user2.2@gvc.ceas-challenge.cc   \n","\n","                              date  \\\n","0  Tue, 05 Aug 2008 16:31:02 -0700   \n","1  Tue, 05 Aug 2008 18:31:03 -0500   \n","2  Tue, 05 Aug 2008 20:28:00 -1200   \n","3  Tue, 05 Aug 2008 17:31:20 -0600   \n","4  Tue, 05 Aug 2008 19:31:21 -0400   \n","\n","                                             subject  \\\n","0                          Never agree to be a loser   \n","1                             Befriend Jenna Jameson   \n","2                               CNN.com Daily Top 10   \n","3  Re: svn commit: r619753 - in /spamassassin/tru...   \n","4                         SpecialPricesPharmMoreinfo   \n","\n","                                                body  label  urls  \n","0  Buck up, your troubles caused by small dimensi...      1     1  \n","1  \\nUpgrade your sex and pleasures with these te...      1     1  \n","2  >+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+...      1     1  \n","3  Would anyone object to removing .so from this ...      0     1  \n","4  \\nWelcomeFastShippingCustomerSupport\\nhttp://7...      1     1  "]},"execution_count":3,"metadata":{},"output_type":"execute_result"}],"source":["df_ceas = pd.read_csv('/kaggle/input/phishing-email-dataset/CEAS_08.csv')\n","df_ceas.head(5)"]},{"cell_type":"code","execution_count":4,"id":"43af3962","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:23.92006Z","iopub.status.busy":"2024-06-06T17:36:23.919648Z","iopub.status.idle":"2024-06-06T17:36:24.243621Z","shell.execute_reply":"2024-06-06T17:36:24.242644Z"},"papermill":{"duration":0.333462,"end_time":"2024-06-06T17:36:24.246103","exception":false,"start_time":"2024-06-06T17:36:23.912641","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sender</th>\n","      <th>receiver</th>\n","      <th>date</th>\n","      <th>subject</th>\n","      <th>body</th>\n","      <th>label</th>\n","      <th>urls</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Robert Elz &lt;kre@munnari.OZ.AU&gt;</td>\n","      <td>Chris Garrigues &lt;cwg-dated-1030377287.06fa6d@D...</td>\n","      <td>Thu, 22 Aug 2002 18:26:25 +0700</td>\n","      <td>Re: New Sequences Window</td>\n","      <td>Date:        Wed, 21 Aug 2002 10:54:46 -0500  ...</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Steve Burt &lt;Steve_Burt@cursor-system.com&gt;</td>\n","      <td>\"'zzzzteana@yahoogroups.com'\" &lt;zzzzteana@yahoo...</td>\n","      <td>Thu, 22 Aug 2002 12:46:18 +0100</td>\n","      <td>[zzzzteana] RE: Alexander</td>\n","      <td>Martin A posted:\\nTassos Papadopoulos, the Gre...</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>\"Tim Chapman\" &lt;timc@2ubh.com&gt;</td>\n","      <td>zzzzteana &lt;zzzzteana@yahoogroups.com&gt;</td>\n","      <td>Thu, 22 Aug 2002 13:52:38 +0100</td>\n","      <td>[zzzzteana] Moscow bomber</td>\n","      <td>Man Threatens Explosion In Moscow \\n\\nThursday...</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Monty Solomon &lt;monty@roscom.com&gt;</td>\n","      <td>undisclosed-recipient: ;</td>\n","      <td>Thu, 22 Aug 2002 09:15:25 -0400</td>\n","      <td>[IRR] Klez: The Virus That  Won't Die</td>\n","      <td>Klez: The Virus That Won't Die\\n \\nAlready the...</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Stewart Smith &lt;Stewart.Smith@ee.ed.ac.uk&gt;</td>\n","      <td>zzzzteana@yahoogroups.com</td>\n","      <td>Thu, 22 Aug 2002 14:38:22 +0100</td>\n","      <td>Re: [zzzzteana] Nothing like mama used to make</td>\n","      <td>&gt;  in adding cream to spaghetti carbonara, whi...</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                      sender  \\\n","0             Robert Elz <kre@munnari.OZ.AU>   \n","1  Steve Burt <Steve_Burt@cursor-system.com>   \n","2              \"Tim Chapman\" <timc@2ubh.com>   \n","3           Monty Solomon <monty@roscom.com>   \n","4  Stewart Smith <Stewart.Smith@ee.ed.ac.uk>   \n","\n","                                            receiver  \\\n","0  Chris Garrigues <cwg-dated-1030377287.06fa6d@D...   \n","1  \"'zzzzteana@yahoogroups.com'\" <zzzzteana@yahoo...   \n","2              zzzzteana <zzzzteana@yahoogroups.com>   \n","3                           undisclosed-recipient: ;   \n","4                          zzzzteana@yahoogroups.com   \n","\n","                              date  \\\n","0  Thu, 22 Aug 2002 18:26:25 +0700   \n","1  Thu, 22 Aug 2002 12:46:18 +0100   \n","2  Thu, 22 Aug 2002 13:52:38 +0100   \n","3  Thu, 22 Aug 2002 09:15:25 -0400   \n","4  Thu, 22 Aug 2002 14:38:22 +0100   \n","\n","                                          subject  \\\n","0                        Re: New Sequences Window   \n","1                       [zzzzteana] RE: Alexander   \n","2                       [zzzzteana] Moscow bomber   \n","3           [IRR] Klez: The Virus That  Won't Die   \n","4  Re: [zzzzteana] Nothing like mama used to make   \n","\n","                                                body  label  urls  \n","0  Date:        Wed, 21 Aug 2002 10:54:46 -0500  ...      0     1  \n","1  Martin A posted:\\nTassos Papadopoulos, the Gre...      0     1  \n","2  Man Threatens Explosion In Moscow \\n\\nThursday...      0     1  \n","3  Klez: The Virus That Won't Die\\n \\nAlready the...      0     1  \n","4  >  in adding cream to spaghetti carbonara, whi...      0     1  "]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["df_SP = pd.read_csv('/kaggle/input/phishing-email-dataset/SpamAssasin.csv')\n","df_SP.head(5)"]},{"cell_type":"code","execution_count":5,"id":"ee8cfa4a","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:24.260487Z","iopub.status.busy":"2024-06-06T17:36:24.259503Z","iopub.status.idle":"2024-06-06T17:36:24.302083Z","shell.execute_reply":"2024-06-06T17:36:24.300937Z"},"papermill":{"duration":0.052363,"end_time":"2024-06-06T17:36:24.304617","exception":false,"start_time":"2024-06-06T17:36:24.252254","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["CEAS_08\n","<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 39154 entries, 0 to 39153\n","Data columns (total 7 columns):\n"," #   Column    Non-Null Count  Dtype \n","---  ------    --------------  ----- \n"," 0   sender    39154 non-null  object\n"," 1   receiver  38692 non-null  object\n"," 2   date      39154 non-null  object\n"," 3   subject   39126 non-null  object\n"," 4   body      39154 non-null  object\n"," 5   label     39154 non-null  int64 \n"," 6   urls      39154 non-null  int64 \n","dtypes: int64(2), object(5)\n","memory usage: 2.1+ MB\n","None\n","(39154, 7)\n","-------------------------\n","SPAMASSASIN\n","<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 5809 entries, 0 to 5808\n","Data columns (total 7 columns):\n"," #   Column    Non-Null Count  Dtype \n","---  ------    --------------  ----- \n"," 0   sender    5809 non-null   object\n"," 1   receiver  5599 non-null   object\n"," 2   date      5809 non-null   object\n"," 3   subject   5793 non-null   object\n"," 4   body      5808 non-null   object\n"," 5   label     5809 non-null   int64 \n"," 6   urls      5809 non-null   int64 \n","dtypes: int64(2), object(5)\n","memory usage: 317.8+ KB\n","None\n","(5809, 7)\n"]}],"source":["print('ceas_08'.upper())\n","print(df_ceas.info())\n","print(df_ceas.shape)\n","print('-------------------------')\n","print('spamassasin'.upper())\n","print(df_SP.info())\n","print(df_SP.shape)"]},{"cell_type":"code","execution_count":6,"id":"9b8bf19f","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:24.318639Z","iopub.status.busy":"2024-06-06T17:36:24.318243Z","iopub.status.idle":"2024-06-06T17:36:24.573346Z","shell.execute_reply":"2024-06-06T17:36:24.572031Z"},"papermill":{"duration":0.264879,"end_time":"2024-06-06T17:36:24.575745","exception":false,"start_time":"2024-06-06T17:36:24.310866","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["MISSING VALUE\n","missing value in CEAS_08:\n","sender        0\n","receiver    462\n","date          0\n","subject      28\n","body          0\n","label         0\n","urls          0\n","dtype: int64\n","-----------------------------\n","missing value in SpamAssasin:\n","sender        0\n","receiver    210\n","date          0\n","subject      16\n","body          1\n","label         0\n","urls          0\n","dtype: int64\n","\n","\n","DUPLICATED VALUE\n","duplicated value in CEAS_08:\n","0\n","-----------------------------\n","duplicated value in SpamAssasin:\n","0\n"]}],"source":["print('missing value'.upper())\n","print('missing value in CEAS_08:')\n","print(df_ceas.isnull().sum())\n","print('-----------------------------')\n","print('missing value in SpamAssasin:')\n","print(df_SP.isnull().sum())\n","print('\\n')\n","print('duplicated value'.upper())\n","print('duplicated value in CEAS_08:')\n","print(df_ceas.duplicated().sum())\n","print('-----------------------------')\n","print('duplicated value in SpamAssasin:')\n","print(df_SP.duplicated().sum())"]},{"cell_type":"code","execution_count":7,"id":"dd8a94e1","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:24.590715Z","iopub.status.busy":"2024-06-06T17:36:24.589935Z","iopub.status.idle":"2024-06-06T17:36:24.598753Z","shell.execute_reply":"2024-06-06T17:36:24.597692Z"},"papermill":{"duration":0.01874,"end_time":"2024-06-06T17:36:24.600957","exception":false,"start_time":"2024-06-06T17:36:24.582217","status":"completed"},"tags":[]},"outputs":[],"source":["percent_ceas = round(df_ceas['subject'].isnull().sum()/df_ceas.shape[0]*100, 2)\n","percent_sp = round(df_SP['subject'].isnull().sum()/df_SP.shape[0]*100, 2)"]},{"cell_type":"code","execution_count":8,"id":"305522bc","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:24.615615Z","iopub.status.busy":"2024-06-06T17:36:24.614768Z","iopub.status.idle":"2024-06-06T17:36:24.645803Z","shell.execute_reply":"2024-06-06T17:36:24.644633Z"},"papermill":{"duration":0.04086,"end_time":"2024-06-06T17:36:24.648149","exception":false,"start_time":"2024-06-06T17:36:24.607289","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["% missing value in CEA_08: 0.07 %\n","% missing value in SpamAssasin: 0.28 %\n","\n","\n","CEAS_08 shape: (39154, 7)\n","SpamAssasin shape: (5809, 7)\n","---------------------------------------\n","CEAS_08 shape: (38669, 7)\n","SpamAssasin shape: (5582, 7)\n"]}],"source":["# calculate the % of missing value and drop it\n","print(f'% missing value in CEA_08: {percent_ceas} %')\n","print(f'% missing value in SpamAssasin: {percent_sp} %')\n","\n","print('\\n')\n","\n","print(f'CEAS_08 shape: {df_ceas.shape}')\n","print(f'SpamAssasin shape: {df_SP.shape}')\n","print('---------------------------------------')\n","\n","df_ceas = df_ceas.dropna()\n","df_SP = df_SP.dropna()\n","\n","print(f'CEAS_08 shape: {df_ceas.shape}')\n","print(f'SpamAssasin shape: {df_SP.shape}')"]},{"cell_type":"code","execution_count":9,"id":"405c78fc","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:24.662578Z","iopub.status.busy":"2024-06-06T17:36:24.662206Z","iopub.status.idle":"2024-06-06T17:36:24.675878Z","shell.execute_reply":"2024-06-06T17:36:24.674866Z"},"papermill":{"duration":0.023378,"end_time":"2024-06-06T17:36:24.67795","exception":false,"start_time":"2024-06-06T17:36:24.654572","status":"completed"},"tags":[]},"outputs":[],"source":["# create sub-dataset on only subject, body and label\n","\n","# sub-dataset\n","df_ceas = df_ceas[['subject', 'body', 'label']]\n","df_SP = df_SP[['subject', 'body', 'label']]\n","\n","# concatinate CEA_08 and SpamAssasin\n","df_mail = pd.concat([df_ceas,df_SP])\n","\n"]},{"cell_type":"code","execution_count":10,"id":"ce5a9523","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:24.692256Z","iopub.status.busy":"2024-06-06T17:36:24.691897Z","iopub.status.idle":"2024-06-06T17:36:24.91382Z","shell.execute_reply":"2024-06-06T17:36:24.912576Z"},"papermill":{"duration":0.231749,"end_time":"2024-06-06T17:36:24.916062","exception":false,"start_time":"2024-06-06T17:36:24.684313","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["(array([20766.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,\n","            0., 23485.]),\n"," array([0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ]),\n"," <BarContainer object of 10 artists>)"]},"execution_count":10,"metadata":{},"output_type":"execute_result"},{"data":{"image/png":"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wx/+oJiYGPsTWB07dlT//v01ZswY7d69W9u3b9e4ceM0bNgwxcTESJJGjBghh8OhlJQUHThwQCtWrND8+fOVlpZmr+Pxxx9XRkaGXnjhBeXl5WnWrFnas2ePxo0b99N3BQAABL16gd5gz5496tu3r/1zRXgkJycrPT1dkyZN0qVLlzR27FidP39ed9xxhzIyMhQeHm7fZunSpRo3bpzuuecehYaGasiQIXrllVfs4263Wxs3blRqaqri4uLUtGlTzZgxw++7dHr37q1ly5Zp+vTpeuqpp/TrX/9aa9asUZcuXaq0EQAAwCw/6Xtygh3fk+OP78kBgJ8vXle+UyffkwMAAPBzQeQAAAAjETkAAMBIRA4AADASkQMAAIxE5AAAACMROQAAwEhEDgAAMBKRAwAAjETkAAAAIxE5AADASEQOAAAwEpEDAACMROQAAAAjETkAAMBIRA4AADASkQMAAIxE5AAAACMROQAAwEhEDgAAMBKRAwAAjETkAAAAIxE5AADASEQOAAAwEpEDAACMROQAAAAjETkAAMBIRA4AADASkQMAAIxE5AAAACMROQAAwEhEDgAAMBKRAwAAjETkAAAAIxE5AADASEQOAAAwEpEDAACMROQAAAAjETkAAMBIRA4AADASkQMAAIxE5AAAACMROQAAwEhEDgAAMBKRAwAAjETkAAAAIxE5AADASEQOAAAwEpEDAACMROQAAAAjETkAAMBIRA4AADASkQMAAIxE5AAAACMROQAAwEhEDgAAMBKRAwAAjETkAAAAIxE5AADASEQOAAAwEpEDAACMROQAAAAjETkAAMBIRA4AADBStUfOrFmzFBIS4nfp0KGDffzy5ctKTU3VDTfcoOuvv15DhgxRQUGB330cP35cSUlJatiwoSIjIzVx4kSVlpb6zWzevFm33nqrnE6n2rZtq/T09Op+KgAAIIjVyDs5nTt31pdffmlftm3bZh+bMGGCPvzwQ61atUpbtmzRqVOndP/999vHy8rKlJSUpOLiYu3YsUPvvPOO0tPTNWPGDHsmPz9fSUlJ6tu3r3JzczV+/Hg99NBD2rBhQ008HQAAEITq1cid1qun6OjoK64vLCzUm2++qWXLlunuu++WJL399tvq2LGjdu7cqV69emnjxo06ePCgPvroI0VFRal79+6aPXu2Jk+erFmzZsnhcGjx4sVq1aqV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","text/plain":["<Figure size 640x480 with 1 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["# plot histogram (label distribution)\n","plt.hist(data=df_mail, x='label')"]},{"cell_type":"markdown","id":"e41ec9c1","metadata":{"papermill":{"duration":0.006411,"end_time":"2024-06-06T17:36:24.929159","exception":false,"start_time":"2024-06-06T17:36:24.922748","status":"completed"},"tags":[]},"source":["# Cleaning"]},{"cell_type":"code","execution_count":11,"id":"503519e4","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:24.944762Z","iopub.status.busy":"2024-06-06T17:36:24.943769Z","iopub.status.idle":"2024-06-06T17:36:25.258588Z","shell.execute_reply":"2024-06-06T17:36:25.255939Z"},"papermill":{"duration":0.331212,"end_time":"2024-06-06T17:36:25.26707","exception":false,"start_time":"2024-06-06T17:36:24.935858","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[nltk_data] Downloading package stopwords to /usr/share/nltk_data...\n","[nltk_data]   Package stopwords is already up-to-date!\n","[nltk_data] Downloading package punkt to /usr/share/nltk_data...\n","[nltk_data]   Package punkt is already up-to-date!\n"]},{"data":{"text/plain":["True"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["nltk.download('stopwords')\n","nltk.download('punkt')"]},{"cell_type":"code","execution_count":12,"id":"8c1a1eb8","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:25.284536Z","iopub.status.busy":"2024-06-06T17:36:25.283674Z","iopub.status.idle":"2024-06-06T17:36:25.289857Z","shell.execute_reply":"2024-06-06T17:36:25.288704Z"},"papermill":{"duration":0.017061,"end_time":"2024-06-06T17:36:25.292016","exception":false,"start_time":"2024-06-06T17:36:25.274955","status":"completed"},"tags":[]},"outputs":[],"source":["# remove punctiation and stopword\n","def clean_data(df):\n","    punct = '/\\.\"\\',!?+=-*#$%@><'\n","    stops = set(stopwords.words('english'))\n","    word_tokens = word_tokenize(df)\n","    filtered_text = [word for word in word_tokens if word.lower() not in punct and word.lower() not in punct and word.strip()]\n","    return ' '.join(filtered_text)"]},{"cell_type":"code","execution_count":13,"id":"5897231e","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:25.308117Z","iopub.status.busy":"2024-06-06T17:36:25.307418Z","iopub.status.idle":"2024-06-06T17:36:25.318408Z","shell.execute_reply":"2024-06-06T17:36:25.317317Z"},"papermill":{"duration":0.021741,"end_time":"2024-06-06T17:36:25.320692","exception":false,"start_time":"2024-06-06T17:36:25.298951","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>subject</th>\n","      <th>body</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Never agree to be a loser</td>\n","      <td>Buck up, your troubles caused by small dimensi...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Befriend Jenna Jameson</td>\n","      <td>\\nUpgrade your sex and pleasures with these te...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>CNN.com Daily Top 10</td>\n","      <td>&gt;+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Re: svn commit: r619753 - in /spamassassin/tru...</td>\n","      <td>Would anyone object to removing .so from this ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>SpecialPricesPharmMoreinfo</td>\n","      <td>\\nWelcomeFastShippingCustomerSupport\\nhttp://7...</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                             subject  \\\n","0                          Never agree to be a loser   \n","1                             Befriend Jenna Jameson   \n","2                               CNN.com Daily Top 10   \n","3  Re: svn commit: r619753 - in /spamassassin/tru...   \n","4                         SpecialPricesPharmMoreinfo   \n","\n","                                                body  label  \n","0  Buck up, your troubles caused by small dimensi...      1  \n","1  \\nUpgrade your sex and pleasures with these te...      1  \n","2  >+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+...      1  \n","3  Would anyone object to removing .so from this ...      0  \n","4  \\nWelcomeFastShippingCustomerSupport\\nhttp://7...      1  "]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["# before\n","df_mail.head(5)"]},{"cell_type":"code","execution_count":14,"id":"1528e5ce","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:36:25.337223Z","iopub.status.busy":"2024-06-06T17:36:25.336859Z","iopub.status.idle":"2024-06-06T17:38:42.248325Z","shell.execute_reply":"2024-06-06T17:38:42.247084Z"},"papermill":{"duration":136.923177,"end_time":"2024-06-06T17:38:42.251176","exception":false,"start_time":"2024-06-06T17:36:25.327999","status":"completed"},"tags":[]},"outputs":[],"source":["# apply function\n","df_mail['subject'] = df_mail['subject'].apply(clean_data)\n","df_mail['body'] = df_mail['body'].apply(clean_data)"]},{"cell_type":"code","execution_count":15,"id":"a0e981de","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:38:42.267482Z","iopub.status.busy":"2024-06-06T17:38:42.267122Z","iopub.status.idle":"2024-06-06T17:38:42.277602Z","shell.execute_reply":"2024-06-06T17:38:42.276598Z"},"papermill":{"duration":0.020828,"end_time":"2024-06-06T17:38:42.279628","exception":false,"start_time":"2024-06-06T17:38:42.2588","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>subject</th>\n","      <th>body</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Never agree to be a loser</td>\n","      <td>Buck up your troubles caused by small dimensio...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Befriend Jenna Jameson</td>\n","      <td>Upgrade your sex and pleasures with these tech...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>CNN.com Daily Top 10</td>\n","      <td>+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Re : svn commit : r619753 in /spamassassin/tru...</td>\n","      <td>Would anyone object to removing .so from this ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>SpecialPricesPharmMoreinfo</td>\n","      <td>WelcomeFastShippingCustomerSupport http : //7i...</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                             subject  \\\n","0                          Never agree to be a loser   \n","1                             Befriend Jenna Jameson   \n","2                               CNN.com Daily Top 10   \n","3  Re : svn commit : r619753 in /spamassassin/tru...   \n","4                         SpecialPricesPharmMoreinfo   \n","\n","                                                body  label  \n","0  Buck up your troubles caused by small dimensio...      1  \n","1  Upgrade your sex and pleasures with these tech...      1  \n","2  +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=...      1  \n","3  Would anyone object to removing .so from this ...      0  \n","4  WelcomeFastShippingCustomerSupport http : //7i...      1  "]},"execution_count":15,"metadata":{},"output_type":"execute_result"}],"source":["# after\n","df_mail.head(5)"]},{"cell_type":"markdown","id":"fd405193","metadata":{"papermill":{"duration":0.006818,"end_time":"2024-06-06T17:38:42.293726","exception":false,"start_time":"2024-06-06T17:38:42.286908","status":"completed"},"tags":[]},"source":["# Data Modeling"]},{"cell_type":"code","execution_count":16,"id":"83d67eab","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:38:42.310055Z","iopub.status.busy":"2024-06-06T17:38:42.309297Z","iopub.status.idle":"2024-06-06T17:39:12.711495Z","shell.execute_reply":"2024-06-06T17:39:12.710422Z"},"papermill":{"duration":30.413663,"end_time":"2024-06-06T17:39:12.714537","exception":false,"start_time":"2024-06-06T17:38:42.300874","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[==================================================] 100.0% 66.0/66.0MB downloaded\n"]}],"source":["# load pre-trained GloVe vectors\n","model = api.load(\"glove-wiki-gigaword-50\")"]},{"cell_type":"code","execution_count":17,"id":"e8200ade","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:39:13.891789Z","iopub.status.busy":"2024-06-06T17:39:13.890733Z","iopub.status.idle":"2024-06-06T17:39:13.896641Z","shell.execute_reply":"2024-06-06T17:39:13.895518Z"},"papermill":{"duration":0.556676,"end_time":"2024-06-06T17:39:13.899126","exception":false,"start_time":"2024-06-06T17:39:13.34245","status":"completed"},"tags":[]},"outputs":[],"source":["# tokenize sentences and convert to vectors\n","def tokenize_and_vectorize(sentence):\n","    tokenized_sentence = word_tokenize(sentence.lower())\n","    return [model[word] for word in tokenized_sentence if word in model]"]},{"cell_type":"code","execution_count":18,"id":"4a24cdf7","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:39:15.040762Z","iopub.status.busy":"2024-06-06T17:39:15.040389Z","iopub.status.idle":"2024-06-06T17:40:47.103315Z","shell.execute_reply":"2024-06-06T17:40:47.102211Z"},"papermill":{"duration":92.668452,"end_time":"2024-06-06T17:40:47.105807","exception":false,"start_time":"2024-06-06T17:39:14.437355","status":"completed"},"tags":[]},"outputs":[],"source":["# apply function \n","df_mail['sub_vector'] = df_mail['subject'].apply(tokenize_and_vectorize)\n","df_mail['body_vector'] = df_mail['body'].apply(tokenize_and_vectorize)\n","\n","# Pad sequences to ensure equal length\n","max_length = 50  # Define the maximum length for padding\n","padded_vectors1 = pad_sequences(df_mail['sub_vector'].tolist(), maxlen=max_length, dtype='float32', padding='post', truncating='post', value=0.0)\n","padded_vectors2 = pad_sequences(df_mail['body_vector'].tolist(), maxlen=max_length, dtype='float32', padding='post', truncating='post', value=0.0)\n"]},{"cell_type":"code","execution_count":19,"id":"b2e5d0dc","metadata":{"execution":{"iopub.execute_input":"2024-06-06T17:40:48.254215Z","iopub.status.busy":"2024-06-06T17:40:48.253496Z","iopub.status.idle":"2024-06-06T17:42:13.670111Z","shell.execute_reply":"2024-06-06T17:42:13.669027Z"},"papermill":{"duration":86.589928,"end_time":"2024-06-06T17:42:14.241981","exception":false,"start_time":"2024-06-06T17:40:47.652053","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.9631680036154107\n","precision: 0.963796058269066\n","recall: 0.9662800687285223\n"]}],"source":["X = padded_vectors1, padded_vectors2\n","y = df_mail['label'].values\n","\n","# concatenate padded vectors along the last axis\n","padded_vectors_combined = np.concatenate((padded_vectors1, padded_vectors2), axis=-1)\n","\n","# extract features and labels\n","X = np.array(padded_vectors_combined)\n","y = df_mail['label'].values\n","\n","# reshape the features for the classifier\n","X_reshaped = X.reshape(X.shape[0], -1)\n","\n","# split data into training and test sets\n","X_train, X_val, y_train, y_val = train_test_split(X_reshaped, y, test_size=0.2, random_state=42)\n","\n","# initialize and train the classifier\n","classifier = LogisticRegression(max_iter=1000)\n","classifier.fit(X_train, y_train)\n","\n","# make predictions on the test data\n","y_pred = classifier.predict(X_val)\n","\n","# evaluate\n","accuracy = accuracy_score(y_val, y_pred)\n","precision = precision_score(y_val, y_pred)\n","recall = recall_score(y_val, y_pred)\n","print(f\"Accuracy: {accuracy}\")\n","print(f\"precision: {precision}\")\n","print(f\"recall: {recall}\")"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"datasetId":5074342,"sourceId":8502378,"sourceType":"datasetVersion"}],"dockerImageVersionId":30732,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.13"},"papermill":{"default_parameters":{},"duration":382.123231,"end_time":"2024-06-06T17:42:17.497392","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-06-06T17:35:55.374161","version":"2.5.0"}},"nbformat":4,"nbformat_minor":5}